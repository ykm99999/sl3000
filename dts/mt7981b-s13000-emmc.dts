// SPDX-License-Identifier: GPL-2.0-or-later OR MIT
/dts-v1/;

#include "mt7981.dtsi"

/ {
    compatible = "s, s13000-emmc", "mediatek,mt7981";
    model = "S13000 eMMC";

    aliases {
        serial0 = &uart0;
        led-boot = &led_status;
        led-failsafe = &led_status;
        led-running = &led_status;
        led-upgrade = &led_status;
    };

    chosen {
        stdout-path = "serial0:115200n8";
    };

    memory {
        device_type = "memory";
        reg = <0x40000000 0x10000000>; /* 256MB，如有需要你再改 */
    };

    leds {
        compatible = "gpio-leds";

        led_status: status {
            label = "s13000:green:status";
            gpios = <&gpio 0 GPIO_ACTIVE_HIGH>;
        };
    };

    keys {
        compatible = "gpio-keys";

        reset {
            label = "reset";
            linux,code = <KEY_RESTART>;
            gpios = <&gpio 1 GPIO_ACTIVE_LOW>;
            debounce-interval = <60>;
        };
    };
};

/* UART */
&uart0 {
    status = "okay";
};

/* eMMC */
&mmc0 {
    pinctrl-names = "default";
    pinctrl-0 = <&mmc0_pins_default>;
    bus-width = <8>;
    max-frequency = <52000000>;
    cap-mmc-highspeed;
    vmmc-supply = <&reg_3p3v>;
    vqmmc-supply = <&reg_1p8v>;
    non-removable;
    status = "okay";
};

/* Ethernet + HNAT */
&eth {
    status = "okay";

    mediatek,hf-1p8v;
    mediatek,mdio = <&mdio>;
    mediatek,ethsys = <&ethsys>;
};

&switch {
    compatible = "mediatek,mt7531";
    status = "okay";
};

/* PCIe + MT7915 */
&pinctrl {
    pcie0_pins: pcie0-pins {
        mux {
            function = "pcie";
            groups = "pcie0";
        };
    };
};

&pcie0 {
    pinctrl-names = "default";
    pinctrl-0 = <&pcie0_pins>;
    status = "okay";

    wifi@0,0 {
        compatible = "mediatek,mt7915e";
        reg = <0 0 0 0 0>;
    };
};

/* 简单的固定电源，按需再细化 */
&pio {
    reg_3p3v: regulator-3p3v {
        compatible = "regulator-fixed";
        regulator-name = "3p3v";
        regulator-min-microvolt = <3300000>;
        regulator-max-microvolt = <3300000>;
        regulator-always-on;
    };

    reg_1p8v: regulator-1p8v {
        compatible = "regulator-fixed";
        regulator-name = "1p8v";
        regulator-min-microvolt = <1800000>;
        regulator-max-microvolt = <1800000>;
        regulator-always-on;
    };
};
